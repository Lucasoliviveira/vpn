#!/bin/bash

# Tornar o script invisível
exec > /dev/null 2>&1

clear
[[ "$(whoami)" != "root" ]] && exit 1

# Mensagem inicial visível
echo -e "\033[1;37mPara iniciar a instalação, digite: \033[1;36m./instalar\033[0m"
sleep 2

# Definir variáveis e funções
_lnk=$(echo 'z1:y#x.5s0ul&p4hs$s.0a72d*n-e!v89e032:3r' | sed -e 's/[^a-z.]//ig' | rev)
_Ink=$(echo '/3×u3#s87r/l32o4×c1a×l1/83×l24×i0b×' | sed -e 's/[^a-z/]//ig')
_1nk=$(echo '/3×u3#s×87r/83×l2×4×i0b×' | sed -e 's/[^a-z/]//ig')

fun_bar() {
  comando[0]="$1"
  comando[1]="$2"
  (
    [[ -e $HOME/fim ]] && rm $HOME/fim
    ${comando[0]} -y
    ${comando[1]} -y
    touch $HOME/fim
  ) &
  while true; do
    [[ -e $HOME/fim ]] && rm $HOME/fim && break
    sleep 0.1s
  done
}

verif_key() {
  krm=$(echo '5:q-3gs2.o7%8:1' | rev)
  chmod +x $_Ink/list
  [[ ! -e "$_Ink/list" ]] && exit 1
}

otimize_python() {
  apt install pip -y
  apt install python3-pip -y
  pip install speedtest-cli
  apt install uuid-runtime
  apt install socat -y
  apt-get install python-minimal -y
  apt-get install libpython-stdlib -y
  apt-get install python -y
  apt-get install python2 -y
  apt-get install python3.6 -y
  apt-get install python3.7 -y
  apt-get install python3.8 -y
  apt-get install python3.9 -y
  update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.6 1
  update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.8 3
  update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.7 2
  update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.9 4
  update-alternatives --set python3 /usr/bin/python3.6
}

fun_attlist() {
  apt-get update -y
  apt-get install lolcat -y
  apt-get install figlet -y
  apt-get install curl -y
  apt install git -y
  apt install figlet boxes -y
  mkdir -p /usr/share/.plus
  echo "crz: $(date)" > /usr/share/.plus/.plus
}

inst_pct() {
  _pacotes=("bc" "screen" "nano" "unzip" "lsof" "netstat" "net-tools" "dos2unix" "nload" "jq" "curl" "figlet" "python3" "python-pip" "firewalld")
  for _prog in ${_pacotes[@]}; do
    apt install $_prog -y
  done
  pip install speedtest-cli
  sudo firewall-cmd --zone=public --permanent --add-port=80/tcp
  sudo firewall-cmd --zone=public --reload
  [[ -f "/usr/sbin/ufw" ]] && ufw allow 443/tcp
}

# Fluxo principal
fun_bar 'fun_attlist'
fun_bar 'otimize_python'
fun_bar 'inst_pct'

# Finalização
echo -e "\033[1;33mINSTALAÇÃO FINALIZADA!\033[0m"
echo -e "\033[1;33mPara iniciar, digite: \033[1;36mmenu\033[0m"
