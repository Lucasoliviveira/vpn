#!/bin/bash
clear

[[ "$(whoami)" != "root" ]] && {
  echo -e "\033[1;37m[\033[1;31mErro\033[1;37m] - Você precisa executar como root!"
  exit 1
}

echo -e "\033[1;37m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo -e "\033[1;32m      BEM VINDO AO SSH PLUS - CONFIGURAÇÃO"
echo -e "\033[1;37m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\033[0m"

read -p "Pressione ENTER para continuar ou CTRL+C para cancelar..."

# Atualização e instalação de dependências
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Atualizando pacotes e instalando dependências...\033[0m"
apt-get update -y && apt-get upgrade -y
apt-get install -y python3 python3-pip git curl figlet lolcat

# Configuração de firewall
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Configurando Firewall...\033[0m"
if command -v firewall-cmd &> /dev/null; then
  firewall-cmd --zone=public --permanent --add-port=80/tcp
  firewall-cmd --zone=public --permanent --add-port=443/tcp
  firewall-cmd --reload
else
  echo -e "\033[1;37m[\033[1;31mAviso\033[1;37m] FirewallD não encontrado. Pulando configuração...\033[0m"
fi

# Criação do comando 'menu'
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Configurando o comando 'menu'...\033[0m"
cat << EOF > /bin/menu
#!/bin/bash
clear
figlet -k "SSH PLUS" | lolcat
echo -e "\033[1;32mBem-vindo ao menu do SSH Plus!\033[0m"
echo -e "\033[1;37m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo -e "\033[1;32m [1] - Opção 1"
echo -e " [2] - Opção 2"
echo -e " [0] - Sair"
echo -e "\033[1;37m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
read -p "Escolha uma opção: " opcao
case \$opcao in
  1) echo "Você escolheu a Opção 1" ;;
  2) echo "Você escolheu a Opção 2" ;;
  0) exit 0 ;;
  *) echo "Opção inválida!" ;;
esac
EOF
chmod +x /bin/menu

# Otimização do Python
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Otimizando o Python...\033[0m"
pip install --upgrade pip
pip install speedtest-cli

# Configurações no .bashrc
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Customizando o ambiente...\033[0m"
echo "clear" >> /root/.bashrc
echo 'figlet -k "SSH PLUS" | lolcat' >> /root/.bashrc
echo 'echo -e "\033[1;32m DIGITE: \033[1;31mmenu\033[0m"' >> /root/.bashrc

# Finalização
echo -e "\n\033[1;37m[\033[1;32mINFO\033[1;37m] Instalação concluída com sucesso!\033[0m"
echo -e "\033[1;37mReinicie o terminal e digite \033[1;31mmenu\033[1;37m para começar.\033[0m"
